<!DOCTYPE html>
<html lang=en >

<head>

  <meta charset=UTF-8>

  <title>Varda Vault</title>
  
<style>
</style>


<!-- dependencies -->
<script src="https://cdn.jsdelivr.net/npm/react@16/umd/react.production.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/react-dom@16/umd/react-dom.production.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/react-is@latest/umd/react-is.production.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/styled-components@5/dist/styled-components.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@microlink/mql@latest/dist/mql.min.js"></script>
<!-- Microlink SDK -->
<script src="https://cdn.jsdelivr.net/npm/@microlink/vanilla@latest/dist/microlink.min.js"></script>
  
  
  <script type=text/javasccript>
  if (document.location.search.match(/type=embed/gi)) {
    window.parent.postMessage(resize, *);
  }
</script>

</head>

<body translate=no >
  <h1>Vault engine for Varda</h1>
  
<form onsubmit="run(); return false;" >
    Store: 
    <input class="owner" type="textbox" value="jilt.near">
    <input id="subvarda" type="submit" value="Submit">
</form>
<div class="target" />
<!-- NFT image -->

      <script >
const run = async () => {
  var owner = document.querySelector('.owner').value;
fetch("https://mintbase-mainnet.hasura.app/v1/graphql", {
  "headers": {
    "content-type": "application/json",
  },
  "body": "{\"query\":\"query MyQuery {\\n  thing(where: {tokens: {ownerId:{_eq: \\\""+owner+"\\\"}}}) {\\n   id \\n  }\\n}\",\"variables\":null,\"operationName\":\"MyQuery\"}",
  "method": "POST",
})
.then(response => response.json())
.then(function(response) { 
const locks = (JSON.stringify(response));
const lockobj = JSON.parse(locks);
const locknfts = lockobj.data.thing;
var html = '';

for(let lockable of locknfts){
			for (var j = 0, k = locknfts.length; j < k; j++) {
			const url = 'https://www.mintbase.io/thing/' + locknfts[j].id + '"';
			html += '<li class="NFT-image"><a href="https://www.mintbase.io/thing/' + locknfts[j].id + '" target="_blank" class="link-preview">Link to your NFT</a></li> ';
			}
			var prevarda = "<script> microlink('.link-preview', { size: 'large' }); <\/script>";
        var el = document.querySelector('.target');
		el.innerHTML = '<ul>' + html + '</ul>'+ prevarda;
    };
  })
  
.then(function (){
    microlink('.link-preview', {
      size: 'large'
    })
  })
};

    </script>


</body>

</html>